<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.97.3" />
<link rel="canonical" type="text/html" href="/v0.1/resource-configuration/">
<link rel="alternate" type="application/rss&#43;xml" href="/v0.1/resource-configuration/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Resource Configuration | Omni</title>
<meta name="description" content="">
<meta property="og:title" content="Resource Configuration" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/v0.1/resource-configuration/" />

<meta itemprop="name" content="Resource Configuration">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Resource Configuration"/>
<meta name="twitter:description" content=""/>




<link rel="preload" href="/scss/main.min.0ef68169fe3e3f67b5cf6bc5f00f55fa4cd0402d35e7d812ee541930f94707e6.css" as="style">
<link href="/scss/main.min.0ef68169fe3e3f67b5cf6bc5f00f55fa4cd0402d35e7d812ee541930f94707e6.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>
<link rel="stylesheet" type="text/css" href="/asciinema/asciinema-player.css" />






  
  
  
    
    
  


<script async src="https://www.googletagmanager.com/gtag/js?id=G-SFLNPVQLRL"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-SFLNPVQLRL', { 'anonymize_ip': false });
}
</script>

  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 203.74 226.05"><defs><style>.cls-1{fill:url(#linear-gradient)}.cls-2{fill:url(#linear-gradient-2)}.cls-3{fill:url(#linear-gradient-3)}.cls-4{fill:url(#linear-gradient-4)}.cls-5{fill:url(#linear-gradient-5)}</style><linearGradient id="linear-gradient" x1="101.85" y1="-12.91" x2="101.85" y2="224.04" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#ffd200"/><stop offset=".08" stop-color="#ffb500"/><stop offset=".2" stop-color="#ff8c00"/><stop offset=".3" stop-color="#ff7300"/><stop offset=".36" stop-color="#ff6a00"/><stop offset=".48" stop-color="#fc4f0e"/><stop offset=".65" stop-color="#f92f1e"/><stop offset=".79" stop-color="#f81b27"/><stop offset=".89" stop-color="#f7142b"/><stop offset="1" stop-color="#df162e"/></linearGradient><linearGradient id="linear-gradient-2" x1="24.84" y1="-12.91" x2="24.84" y2="224.04" xlink:href="#linear-gradient"/><linearGradient id="linear-gradient-3" x1="178.9" y1="-12.91" x2="178.9" y2="224.04" xlink:href="#linear-gradient"/><linearGradient id="linear-gradient-4" x1="145.06" y1="-12.91" x2="145.06" y2="224.04" xlink:href="#linear-gradient"/><linearGradient id="linear-gradient-5" x1="58.64" y1="-12.91" x2="58.64" y2="224.04" xlink:href="#linear-gradient"/></defs><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path class="cls-1" d="M101.89 226.05c2.85.0 5.67-.15 8.46-.35V.35c-2.8-.21-5.62-.35-8.48-.35s-5.7.14-8.52.35V225.69c2.81.21 5.64.35 8.5.36z"/><path class="cls-2" d="M11.56 50.9 9.12 48.47A112.82 112.82.0 00.2 63.61c29.42 29.89 32.52 44.31 32.48 49.14C32.57 125 17.58 144.21.0 162a113.69 113.69.0 008.84 15.15c1-1 1.95-1.92 2.92-2.9 25.37-25.54 37.77-45.61 37.92-61.38S37.36 77 11.56 50.9z"/><path class="cls-3" d="M192 174.29l2.92 2.9A113.69 113.69.0 00203.74 162c-17.57-17.83-32.56-37.09-32.68-49.29-.11-11.9 14.79-31.15 32.46-49.18a112.88 112.88.0 00-8.9-15.1l-2.44 2.43c-25.8 26.05-38.27 46.34-38.12 62s12.55 35.89 37.94 61.43z"/><path class="cls-4" d="M140.68 112.83c0-22 9.81-58.58 24.92-93.15A113 113 0 00150.45 11c-16.54 37.27-26.78 76.91-26.78 101.87.0 24.15 11.09 64.23 27.93 101.7a113 113 0 0014.84-8.77c-15.59-35.07-25.76-71.73-25.76-92.97z"/><path class="cls-5" d="M80 112.83C80 87.74 69.35 47.88 53 11.07a112.76 112.76.0 00-14.93 8.64C53.21 54.26 63 90.85 63 112.83c0 21.23-10.17 57.88-25.76 92.91a113.66 113.66.0 0014.84 8.77C68.94 177.05 80 137 80 112.83z"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Omni</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://talos.dev" target="_blank" ><span>Talos Linux</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/siderolabs" target="_blank" ><span>GitHub</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://www.siderolabs.com" target="_blank" ><span>Sidero Labs</span></a>
			</li>
			
			
			<li class="nav-item dropdown mr-4 d-none d-lg-block">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Releases
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/v0.6">v0.6 (pre-release)</a>
	
	<a class="dropdown-item" href="/v0.5">v0.5 (latest)</a>
	
	<a class="dropdown-item" href="/v0.4">v0.4</a>
	
	<a class="dropdown-item" href="/v0.3">v0.3</a>
	
	<a class="dropdown-item" href="/v0.2">v0.2</a>
	
	<a class="dropdown-item" href="/v0.1">v0.1</a>
	
</div>

			</li>
			
			
      <li id="algolia-search"></li>
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"></div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/v0.1/resource-configuration/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Resource Configuration</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-022a19dcc58cd84e34cf81298133c8e3">Environments</a></li>


    
  
    
    
	
<li>2: <a href="#pg-10a079f83e5a6b98a91b6028c5a620d2">Servers</a></li>


    
  
    
    
	
<li>3: <a href="#pg-9e70eccc19ec5689c5ca2a9204b66906">Server Classes</a></li>


    
  
    
    
	
<li>4: <a href="#pg-d6820383151ccd2bd9527755c916564e">Metadata</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-022a19dcc58cd84e34cf81298133c8e3">1 - Environments</h1>
    
	<p>Environments are a custom resource provided by the Metal Controller Manager.
An environment is a codified description of what should be returned by the PXE server when a physical server attempts to PXE boot.</p>
<p>Especially important in the environment types are the kernel args.
From here, one can tweak the IP to the metadata server as well as various other kernel options that <a href="https://www.talos.dev/latest/reference/kernel/">Talos</a> and/or the Linux kernel supports.</p>
<p>Environments can be supplied to a given server either at the Server or the ServerClass level.
The hierarchy from most to least respected is:</p>
<ul>
<li><code>.spec.environmentRef</code> provided at <code>Server</code> level</li>
<li><code>.spec.environmentRef</code> provided at <code>ServerClass</code> level</li>
<li><code>&quot;default&quot;</code> <code>Environment</code> created by administrator</li>
</ul>
<p>A sample environment definition looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#268bd2">apiVersion</span>: metal.sidero.dev/v1alpha1
</span></span><span style="display:flex;"><span><span style="color:#268bd2">kind</span>: Environment
</span></span><span style="display:flex;"><span><span style="color:#268bd2">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">name</span>: default
</span></span><span style="display:flex;"><span><span style="color:#268bd2">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">kernel</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">url</span>: <span style="color:#2aa198">&#34;https://github.com/talos-systems/talos/releases/download/v0.8.1/vmlinuz-amd64&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">sha512</span>: <span style="color:#2aa198">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">args</span>:
</span></span><span style="display:flex;"><span>      - init_on_alloc=1
</span></span><span style="display:flex;"><span>      - init_on_free=1
</span></span><span style="display:flex;"><span>      - slab_nomerge
</span></span><span style="display:flex;"><span>      - pti=on
</span></span><span style="display:flex;"><span>      - consoleblank=0
</span></span><span style="display:flex;"><span>      - random.trust_cpu=on
</span></span><span style="display:flex;"><span>      - ima_template=ima-ng
</span></span><span style="display:flex;"><span>      - ima_appraise=fix
</span></span><span style="display:flex;"><span>      - ima_hash=sha512
</span></span><span style="display:flex;"><span>      - console=tty0
</span></span><span style="display:flex;"><span>      - console=ttyS1,115200n8
</span></span><span style="display:flex;"><span>      - earlyprintk=ttyS1,115200n8
</span></span><span style="display:flex;"><span>      - panic=0
</span></span><span style="display:flex;"><span>      - printk.devkmsg=on
</span></span><span style="display:flex;"><span>      - talos.platform=metal
</span></span><span style="display:flex;"><span>      - talos.config=http://$PUBLIC_IP:9091/configdata?uuid=
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">initrd</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">url</span>: <span style="color:#2aa198">&#34;https://github.com/talos-systems/talos/releases/download/v0.8.1/initramfs-amd64.xz&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">sha512</span>: <span style="color:#2aa198">&#34;&#34;</span>
</span></span></code></pre></div><p>Example of overriding <code>&quot;default&quot;</code> <code>Environment</code> at the <code>Server</code> level:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#268bd2">apiVersion</span>: metal.sidero.dev/v1alpha1
</span></span><span style="display:flex;"><span><span style="color:#268bd2">kind</span>: Server
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#268bd2">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">environmentRef</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">namespace</span>: default
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">name</span>: boot
</span></span><span style="display:flex;"><span>  ...
</span></span></code></pre></div><p>Example of overriding <code>&quot;default&quot;</code> <code>Environment</code> at the <code>ServerClass</code> level:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#268bd2">apiVersion</span>: metal.sidero.dev/v1alpha1
</span></span><span style="display:flex;"><span><span style="color:#268bd2">kind</span>: ServerClass
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#268bd2">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">environmentRef</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">namespace</span>: default
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">name</span>: boot
</span></span><span style="display:flex;"><span>  ...
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-10a079f83e5a6b98a91b6028c5a620d2">2 - Servers</h1>
    
	<p>Servers are the basic resource of bare metal in the Metal Controller Manager.
These are created by PXE booting the servers and allowing them to send a registration request to the management plane.</p>
<p>An example server may look like the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#268bd2">apiVersion</span>: metal.sidero.dev/v1alpha1
</span></span><span style="display:flex;"><span><span style="color:#268bd2">kind</span>: Server
</span></span><span style="display:flex;"><span><span style="color:#268bd2">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">name</span>: <span style="color:#2aa198">00000000-0000-0000-0000</span>-d05099d333e0
</span></span><span style="display:flex;"><span><span style="color:#268bd2">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">accepted</span>: <span style="color:#cb4b16">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">configPatches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#268bd2">op</span>: replace
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">path</span>: /cluster/network/cni
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">value</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">name</span>: custom
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">urls</span>:
</span></span><span style="display:flex;"><span>          - http://192.168.1.199/assets/cilium.yaml
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">cpu</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">manufacturer</span>: Intel(R) Corporation
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">version</span>: Intel(R) Atom(TM) CPU C3558 @ 2.20GHz
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">system</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">family</span>: Unknown
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">manufacturer</span>: Unknown
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">productName</span>: Unknown
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">serialNumber</span>: Unknown
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">skuNumber</span>: Unknown
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">version</span>: Unknown
</span></span></code></pre></div><h2 id="installation-disk">Installation Disk</h2>
<p>A an installation disk is required by Talos on bare metal.
This can be specified in a <code>configPatch</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#268bd2">apiVersion</span>: metal.sidero.dev/v1alpha1
</span></span><span style="display:flex;"><span><span style="color:#268bd2">kind</span>: Server
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#268bd2">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">accepted</span>: <span style="color:#cb4b16">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">configPatches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#268bd2">op</span>: replace
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">path</span>: /machine/install/disk
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">value</span>: /dev/sda
</span></span></code></pre></div><p>The install disk patch can also be set on the <code>ServerClass</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#268bd2">apiVersion</span>: metal.sidero.dev/v1alpha1
</span></span><span style="display:flex;"><span><span style="color:#268bd2">kind</span>: ServerClass
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#268bd2">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">configPatches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#268bd2">op</span>: replace
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">path</span>: /machine/install/disk
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">value</span>: /dev/sda
</span></span></code></pre></div><h2 id="server-acceptance">Server Acceptance</h2>
<p>In order for a server to be eligible for consideration, it <em>must</em> be <code>accepted</code>.
This is an important separation point which all <code>Server</code>s must pass.
Before a <code>Server</code> is accepted, no write action will be performed against it.
Thus, it is safe for a computer to be added to a network on which Sidero is operating.
Sidero will never write to or wipe any disk on a computer which is not marked as <code>accepted</code>.</p>
<p>This can be tedious for systems in which all attached computers should be considered to be under the control of Sidero.
Thus, you may also choose to automatically accept any machine into Sidero on its discovery.
Please keep in mind that this means that any newly-connected computer <strong>WILL BE WIPED</strong> automatically.
You can enable auto-acceptance by pasing the <code>--auto-accept-servers=true</code> flag to <code>sidero-controller-manager</code>.</p>
<p>Once accepted, a server will be reset (all disks wiped) and then made available to Sidero.</p>
<p>You should never change an accepted <code>Server</code> to be <em>not</em> accepted while it is in use.
Because servers which are not accepted will not be modified, if a server which
<em>was</em> accepted is changed to <em>not</em> accepted, the disk will <em>not</em> be wiped upon
its exit.</p>
<h2 id="ipmi">IPMI</h2>
<p>Sidero can use IPMI information to control <code>Server</code> power state, reboot servers and set boot order.</p>
<p>IPMI connection information can be set in the <code>Server</code> spec after initial registration:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#268bd2">apiVersion</span>: metal.sidero.dev/v1alpha1
</span></span><span style="display:flex;"><span><span style="color:#268bd2">kind</span>: Server
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#268bd2">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">bmc</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">endpoint</span>: <span style="color:#2aa198">10.0.0.25</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">user</span>: admin
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">pass</span>: password
</span></span></code></pre></div><p>If IPMI information is set, server boot order might be set to boot from disk, then network, Sidero will switch servers
to PXE boot once that is required.</p>
<p>Without IPMI info, Sidero can still register servers, wipe them and provision clusters, but Sidero won&rsquo;t be able to reboot servers once they are removed from the cluster.
If IPMI info is not set, servers should be configured to boot first from network, then from disk.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9e70eccc19ec5689c5ca2a9204b66906">3 - Server Classes</h1>
    
	<p>Server classes are a way to group distinct server resources.
The &ldquo;qualifiers&rdquo; key allows the administrator to specify criteria upon which to group these servers.
There are currently three keys: <code>cpu</code>, <code>systemInformation</code>, and <code>labelSelectors</code>.
Each of these keys accepts a list of entries.
The top level keys are a &ldquo;logical AND&rdquo;, while the lists under each key are a &ldquo;logical OR&rdquo;.
Qualifiers that are not specified are not evaluated.</p>
<p>An example:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#268bd2">apiVersion</span>: metal.sidero.dev/v1alpha1
</span></span><span style="display:flex;"><span><span style="color:#268bd2">kind</span>: ServerClass
</span></span><span style="display:flex;"><span><span style="color:#268bd2">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">name</span>: default
</span></span><span style="display:flex;"><span><span style="color:#268bd2">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">qualifiers</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">cpu</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#268bd2">manufacturer</span>: Intel(R) Corporation
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">version</span>: Intel(R) Atom(TM) CPU C3558 @ 2.20GHz
</span></span><span style="display:flex;"><span>      - <span style="color:#268bd2">manufacturer</span>: Advanced Micro Devices, Inc.
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">version</span>: AMD Ryzen 7 2700X Eight-Core Processor
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">labelSelectors</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#268bd2">&#34;my-server-label&#34;: </span><span style="color:#2aa198">&#34;true&#34;</span>
</span></span></code></pre></div><p>Servers would only be added to the above class if they had <em>EITHER</em> CPU info, <em>AND</em> the label associated with the server resource.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d6820383151ccd2bd9527755c916564e">4 - Metadata</h1>
    
	<p>The Metadata server manages the Machine metadata.
In terms of Talos (the OS on which the Kubernetes cluster is formed), this is the
&ldquo;<a href="https://www.talos.dev/latest/reference/configuration/">machine config</a>&rdquo;,
which is used during the automated installation.</p>
<h2 id="talos-machine-configuration">Talos Machine Configuration</h2>
<p>The configuration of each machine is constructed from a number of sources:</p>
<ul>
<li>The Talos bootstrap provider.</li>
<li>The <code>Cluster</code> of which the <code>Machine</code> is a member.</li>
<li>The <code>ServerClass</code> which was used to select the <code>Server</code> into the <code>Cluster</code>.</li>
<li>Any <code>Server</code>-specific patches.</li>
</ul>
<p>The base template is constructed from the Talos bootstrap provider, using data from the associated <code>Cluster</code> manifest.
Then, any configuration patches are applied from the <code>ServerClass</code> and <code>Server</code>.</p>
<p>Only configuration patches are allowed in the <code>ServerClass</code> and <code>Server</code> resources.
These patches take the form of an <a href="https://tools.ietf.org/html/rfc6902">RFC 6902</a> JSON (or YAML) patch.
An example of the use of this patch method can be found in <a href="../../guides/patching/">Patching Guide</a>.</p>
<p>Also note that while a <code>Server</code> can be a member of any number of <code>ServerClass</code>es, only the <code>ServerClass</code> which is used to select the <code>Server</code> into the <code>Cluster</code> will be used for the generation of the configuration of the <code>Machine</code>.
In this way, <code>Servers</code> may have a number of different configuration patch sets based on which <code>Cluster</code> they are in at any given time.</p>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/SideroLabs" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/siderolabs" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 Sidero Labs, Inc. All Rights Reserved</small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>


















<script src="/js/main.min.68e31ec429bf4c76d0cfc803a06912682cfe4274c4cafeb4d70d00cfe3c3b618.js" integrity="sha256-aOMexCm/THbQz8gDoGkSaCz&#43;QnTEyv601w0Az&#43;PDthg=" crossorigin="anonymous"></script>








<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>



<script>
  docsearch({
    appId: "0UBMNL8U2A",
    apiKey: "b23cc1d9c0b406b2d1b83f0c652ead8a",
    indexName: "sidero",
    container: '#algolia-search',
    debug: true,
    searchParameters: {
      facetFilters: ['version:v0.1'],
    },
  });
</script>






<meta name="docsearch:version" content="v0.1" />




  </body>
</html>
